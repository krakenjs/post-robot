!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("postRobot",[],t):"object"==typeof exports?exports.postRobot=t():n.postRobot=t()}("undefined"!=typeof self?self:this,(function(){return function(n){var t={};function e(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:r})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var o in n)e.d(r,o,function(t){return n[t]}.bind(null,o));return r},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return{}.hasOwnProperty.call(n,t)},e.p="",e(e.s=6)}([function(n,t,e){"undefined"!=typeof self&&self,n.exports=function(n){var t={};function e(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:r})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var o in n)e.d(r,o,function(t){return n[t]}.bind(null,o));return r},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return{}.hasOwnProperty.call(n,t)},e.p="",e(e.s=1)}([,function(n,t,e){"use strict";function r(n){return"[object RegExp]"==={}.toString.call(n)}e.r(t),e.d(t,"getActualProtocol",(function(){return c})),e.d(t,"getProtocol",(function(){return s})),e.d(t,"isFileProtocol",(function(){return f})),e.d(t,"isAboutProtocol",(function(){return d})),e.d(t,"isMockProtocol",(function(){return l})),e.d(t,"getParent",(function(){return h})),e.d(t,"getOpener",(function(){return w})),e.d(t,"canReadFromWindow",(function(){return m})),e.d(t,"getActualDomain",(function(){return v})),e.d(t,"getDomain",(function(){return p})),e.d(t,"isBlankDomain",(function(){return y})),e.d(t,"isActuallySameDomain",(function(){return g})),e.d(t,"isSameDomain",(function(){return _})),e.d(t,"assertSameDomain",(function(){return b})),e.d(t,"getParents",(function(){return W})),e.d(t,"isAncestorParent",(function(){return O})),e.d(t,"getFrames",(function(){return j})),e.d(t,"getAllChildFrames",(function(){return P})),e.d(t,"getTop",(function(){return k})),e.d(t,"getNextOpener",(function(){return E})),e.d(t,"getUltimateTop",(function(){return x})),e.d(t,"getAllFramesInWindow",(function(){return S})),e.d(t,"getAllWindows",(function(){return D})),e.d(t,"isTop",(function(){return C})),e.d(t,"isFrameWindowClosed",(function(){return A})),e.d(t,"isWindowClosed",(function(){return I})),e.d(t,"linkFrameWindow",(function(){return N})),e.d(t,"getUserAgent",(function(){return R})),e.d(t,"getFrameByName",(function(){return z})),e.d(t,"findChildFrameByName",(function(){return F})),e.d(t,"findFrameByName",(function(){return L})),e.d(t,"isParent",(function(){return Z})),e.d(t,"isOpener",(function(){return B})),e.d(t,"getAncestor",(function(){return q})),e.d(t,"getAncestors",(function(){return U})),e.d(t,"isAncestor",(function(){return H})),e.d(t,"isPopup",(function(){return J})),e.d(t,"isIframe",(function(){return K})),e.d(t,"isFullpage",(function(){return Y})),e.d(t,"getDistanceFromTop",(function(){return G})),e.d(t,"getNthParent",(function(){return Q})),e.d(t,"getNthParentFromTop",(function(){return V})),e.d(t,"isSameTopWindow",(function(){return X})),e.d(t,"matchDomain",(function(){return nn})),e.d(t,"stringifyDomainPattern",(function(){return tn})),e.d(t,"getDomainFromUrl",(function(){return en})),e.d(t,"onCloseWindow",(function(){return rn})),e.d(t,"isWindow",(function(){return on})),e.d(t,"isBrowser",(function(){return un})),e.d(t,"isCurrentDomain",(function(){return an})),e.d(t,"isMockDomain",(function(){return cn})),e.d(t,"normalizeMockUrl",(function(){return sn})),e.d(t,"getFrameForWindow",(function(){return fn})),e.d(t,"closeWindow",(function(){return dn})),e.d(t,"PROTOCOL",(function(){return o})),e.d(t,"WILDCARD",(function(){return i})),e.d(t,"WINDOW_TYPE",(function(){return u}));var o={MOCK:"mock:",FILE:"file:",ABOUT:"about:"},i="*",u={IFRAME:"iframe",POPUP:"popup"},a="Call was rejected by callee.\r\n";function c(n){return void 0===n&&(n=window),n.location.protocol}function s(n){if(void 0===n&&(n=window),n.mockDomain){var t=n.mockDomain.split("//")[0];if(t)return t}return c(n)}function f(n){return void 0===n&&(n=window),s(n)===o.FILE}function d(n){return void 0===n&&(n=window),s(n)===o.ABOUT}function l(n){return void 0===n&&(n=window),s(n)===o.MOCK}function h(n){if(void 0===n&&(n=window),n)try{if(n.parent&&n.parent!==n)return n.parent}catch(n){}}function w(n){if(void 0===n&&(n=window),n&&!h(n))try{return n.opener}catch(n){}}function m(n){try{return!0}catch(n){}return!1}function v(n){void 0===n&&(n=window);var t=n.location;if(!t)throw new Error("Can not read window location");var e=c(n);if(!e)throw new Error("Can not read window protocol");if(e===o.FILE)return o.FILE+"//";if(e===o.ABOUT){var r=h(n);return r&&m()?v(r):o.ABOUT+"//"}var i=t.host;if(!i)throw new Error("Can not read window host");return e+"//"+i}function p(n){void 0===n&&(n=window);var t=v(n);return t&&n.mockDomain&&n.mockDomain.startsWith(o.MOCK)?n.mockDomain:t}function y(n){try{if(!n.location.href)return!0;if("about:blank"===n.location.href)return!0}catch(n){}return!1}function g(n){try{if(n===window)return!0}catch(n){}try{var t=Object.getOwnPropertyDescriptor(n,"location");if(t&&!1===t.enumerable)return!1}catch(n){}try{if(d(n)&&m())return!0}catch(n){}try{if(l(n)&&m())return!0}catch(n){}try{if(v(n)===v(window))return!0}catch(n){}return!1}function _(n){if(!g(n))return!1;try{if(n===window)return!0;if(d(n)&&m())return!0;if(p(window)===p(n))return!0}catch(n){}return!1}function b(n){if(!_(n))throw new Error("Expected window to be same domain");return n}function W(n){var t=[];try{for(;n.parent!==n;)t.push(n.parent),n=n.parent}catch(n){}return t}function O(n,t){if(!n||!t)return!1;var e=h(t);return e?e===n:!!W(t).includes(n)}function j(n){var t,e,r=[];try{t=n.frames}catch(e){t=n}try{e=t.length}catch(n){}if(0===e)return r;if(e){for(var o=0;o<e;o++){var i=void 0;try{i=t[o]}catch(n){continue}r.push(i)}return r}for(var u=0;u<100;u++){var a=void 0;try{a=t[u]}catch(n){return r}if(!a)return r;r.push(a)}return r}function P(n){for(var t=[],e=0,r=j(n);e<r.length;e++){var o=r[e];t.push(o);for(var i=0,u=P(o);i<u.length;i++)t.push(u[i])}return t}function k(n){void 0===n&&(n=window);try{if(n.top)return n.top}catch(n){}if(h(n)===n)return n;try{if(O(window,n)&&window.top)return window.top}catch(n){}try{if(O(n,window)&&window.top)return window.top}catch(n){}for(var t=0,e=P(n);t<e.length;t++){var r=e[t];try{if(r.top)return r.top}catch(n){}if(h(r)===r)return r}}function E(n){return void 0===n&&(n=window),w(k(n)||n)}function x(n){void 0===n&&(n=window);var t=E(n);return t?x(t):top}function S(n){var t=k(n);if(!t)throw new Error("Can not determine top window");var e=[].concat(P(t),[t]);return e.includes(n)||(e=[].concat(e,[n],P(n))),e}function D(n){void 0===n&&(n=window);var t=S(n),e=E(n);return e?[].concat(D(e),t):t}function C(n){return n===k(n)}function A(n){if(!n.contentWindow)return!0;if(!n.parentNode)return!0;var t=n.ownerDocument;if(t&&t.documentElement&&!t.documentElement.contains(n)){for(var e=n;e.parentNode&&e.parentNode!==e;)e=e.parentNode;if(!e.host||!t.documentElement.contains(e.host))return!0}return!1}var M=[],T=[];function I(n,t){void 0===t&&(t=!0);try{if(n===window)return!1}catch(n){return!0}try{if(!n)return!0}catch(n){return!0}try{if(n.closed)return!0}catch(n){return!n||n.message!==a}if(t&&_(n))try{if(n.mockclosed)return!0}catch(n){}try{if(!n.parent||!n.top)return!0}catch(n){}var e=function(n,t){for(var e=0;e<n.length;e++)try{if(n[e]===t)return e}catch(n){}return-1}(M,n);if(-1!==e){var r=T[e];if(r&&A(r))return!0}return!1}function N(n){if(function(){for(var n=0;n<M.length;n++){var t=!1;try{t=M[n].closed}catch(n){}t&&(T.splice(n,1),M.splice(n,1))}}(),n&&n.contentWindow)try{M.push(n.contentWindow),T.push(n)}catch(n){}}function R(n){return(n=n||window).navigator.mockUserAgent||n.navigator.userAgent}function z(n,t){for(var e=j(n),r=0;r<e.length;r++){var o=e[r];try{if(_(o)&&o.name===t&&e.includes(o))return o}catch(n){}}try{if(e.includes(n.frames[t]))return n.frames[t]}catch(n){}try{if(e.includes(n[t]))return n[t]}catch(n){}}function F(n,t){var e=z(n,t);if(e)return e;for(var r=0,o=j(n);r<o.length;r++){var i=F(o[r],t);if(i)return i}}function L(n,t){return z(n,t)||F(k(n)||n,t)}function Z(n,t){var e=h(t);if(e)return e===n;for(var r=0,o=j(n);r<o.length;r++)if(o[r]===t)return!0;return!1}function B(n,t){return n===w(t)}function q(n){return void 0===n&&(n=window),w(n=n||window)||h(n)||void 0}function U(n){for(var t=[],e=n;e;)(e=q(e))&&t.push(e);return t}function H(n,t){var e=q(t);if(e)return e===n;if(t===n)return!1;if(k(t)===t)return!1;for(var r=0,o=j(n);r<o.length;r++)if(o[r]===t)return!0;return!1}function J(n){return void 0===n&&(n=window),Boolean(w(n))}function K(n){return void 0===n&&(n=window),Boolean(h(n))}function Y(n){return void 0===n&&(n=window),Boolean(!K(n)&&!J(n))}function $(n,t){for(var e=0;e<n.length;e++)for(var r=n[e],o=0;o<t.length;o++)if(r===t[o])return!0;return!1}function G(n){void 0===n&&(n=window);for(var t=0,e=n;e;)(e=h(e))&&(t+=1);return t}function Q(n,t){void 0===t&&(t=1);for(var e=n,r=0;r<t;r++){if(!e)return;e=h(e)}return e}function V(n,t){return void 0===t&&(t=1),Q(n,G(n)-t)}function X(n,t){var e=k(n)||n,r=k(t)||t;try{if(e&&r)return e===r}catch(n){}var o=S(n),i=S(t);if($(o,i))return!0;var u=w(e),a=w(r);return u&&$(S(u),i)||a&&$(S(a),o),!1}function nn(n,t){if("string"==typeof n){if("string"==typeof t)return n===i||t===n;if(r(t))return!1;if(Array.isArray(t))return!1}return r(n)?r(t)?n.toString()===t.toString():!Array.isArray(t)&&Boolean(t.match(n)):!!Array.isArray(n)&&(Array.isArray(t)?JSON.stringify(n)===JSON.stringify(t):!r(t)&&n.some((function(n){return nn(n,t)})))}function tn(n){return Array.isArray(n)?"("+n.join(" | ")+")":r(n)?"RegExp("+n.toString()+")":n.toString()}function en(n){return/^(https?|mock|file):\/\//.exec(n)?n.split("/").slice(0,3).join("/"):p()}function rn(n,t,e,r){var o;return void 0===e&&(e=1e3),void 0===r&&(r=1/0),function i(){if(I(n))return o&&clearTimeout(o),t();r<=0?clearTimeout(o):(r-=e,o=setTimeout(i,e))}(),{cancel:function(){o&&clearTimeout(o)}}}function on(n){try{if(n===window)return!0}catch(n){if(n&&n.message===a)return!0}try{if("[object Window]"==={}.toString.call(n))return!0}catch(n){if(n&&n.message===a)return!0}try{if(window.Window&&n instanceof window.Window)return!0}catch(n){if(n&&n.message===a)return!0}try{if(n&&n.self===n)return!0}catch(n){if(n&&n.message===a)return!0}try{if(n&&n.parent===n)return!0}catch(n){if(n&&n.message===a)return!0}try{if(n&&n.top===n)return!0}catch(n){if(n&&n.message===a)return!0}try{if(n&&"__unlikely_value__"===n.__cross_domain_utils_window_check__)return!1}catch(n){return!0}try{if("postMessage"in n&&"self"in n&&"location"in n)return!0}catch(n){}return!1}function un(){return"undefined"!=typeof window&&void 0!==window.location}function an(n){return!!un()&&p()===n}function cn(n){return n.startsWith(o.MOCK)}function sn(n){if(!cn(en(n)))return n;throw new Error("Mock urls not supported out of test mode")}function fn(n){if(_(n))return b(n).frameElement;for(var t=0,e=document.querySelectorAll("iframe");t<e.length;t++){var r=e[t];if(r&&r.contentWindow&&r.contentWindow===n)return r}}function dn(n){if(K(n)){var t=fn(n);if(t&&t.parentElement)return void t.parentElement.removeChild(t)}try{n.close()}catch(n){}}}])},function(n,t,e){n.exports=e(5)},,function(n,t,e){"undefined"!=typeof self&&self,n.exports=function(n){var t={};function e(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:r})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var o in n)e.d(r,o,function(t){return n[t]}.bind(null,o));return r},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return{}.hasOwnProperty.call(n,t)},e.p="",e(e.s=0)}([function(n,t,e){"use strict";e.r(t),e.d(t,"WeakMap",(function(){return m}));var r="Call was rejected by callee.\r\n";function o(n){return void 0===n&&(n=window),n.location.protocol}function i(n){if(void 0===n&&(n=window),n.mockDomain){var t=n.mockDomain.split("//")[0];if(t)return t}return o(n)}function u(n){return void 0===n&&(n=window),"about:"===i(n)}function a(n){try{return!0}catch(n){}return!1}function c(n){void 0===n&&(n=window);var t=n.location;if(!t)throw new Error("Can not read window location");var e=o(n);if(!e)throw new Error("Can not read window protocol");if("file:"===e)return"file://";if("about:"===e){var r=function(n){if(void 0===n&&(n=window),n)try{if(n.parent&&n.parent!==n)return n.parent}catch(n){}}(n);return r&&a()?c(r):"about://"}var i=t.host;if(!i)throw new Error("Can not read window host");return e+"//"+i}function s(n){void 0===n&&(n=window);var t=c(n);return t&&n.mockDomain&&0===n.mockDomain.indexOf("mock:")?n.mockDomain:t}var f=[],d=[];function l(n,t){void 0===t&&(t=!0);try{if(n===window)return!1}catch(n){return!0}try{if(!n)return!0}catch(n){return!0}try{if(n.closed)return!0}catch(n){return!n||n.message!==r}if(t&&function(n){if(!function(n){try{if(n===window)return!0}catch(n){}try{var t=Object.getOwnPropertyDescriptor(n,"location");if(t&&!1===t.enumerable)return!1}catch(n){}try{if(u(n)&&a())return!0}catch(n){}try{if(function(n){return void 0===n&&(n=window),"mock:"===i(n)}(n)&&a())return!0}catch(n){}try{if(c(n)===c(window))return!0}catch(n){}return!1}(n))return!1;try{if(n===window)return!0;if(u(n)&&a())return!0;if(s(window)===s(n))return!0}catch(n){}return!1}(n))try{if(n.mockclosed)return!0}catch(n){}try{if(!n.parent||!n.top)return!0}catch(n){}var e=function(n,t){for(var e=0;e<n.length;e++)try{if(n[e]===t)return e}catch(n){}return-1}(f,n);if(-1!==e){var o=d[e];if(o&&function(n){if(!n.contentWindow)return!0;if(!n.parentNode)return!0;var t=n.ownerDocument;if(t&&t.documentElement&&!t.documentElement.contains(n)){for(var e=n;e.parentNode&&e.parentNode!==e;)e=e.parentNode;if(!e.host||!t.documentElement.contains(e.host))return!0}return!1}(o))return!0}return!1}function h(n){try{if(n===window)return!0}catch(n){if(n&&n.message===r)return!0}try{if("[object Window]"==={}.toString.call(n))return!0}catch(n){if(n&&n.message===r)return!0}try{if(window.Window&&n instanceof window.Window)return!0}catch(n){if(n&&n.message===r)return!0}try{if(n&&n.self===n)return!0}catch(n){if(n&&n.message===r)return!0}try{if(n&&n.parent===n)return!0}catch(n){if(n&&n.message===r)return!0}try{if(n&&n.top===n)return!0}catch(n){if(n&&n.message===r)return!0}try{if(n&&"__unlikely_value__"===n.__cross_domain_utils_window_check__)return!1}catch(n){return!0}try{if("postMessage"in n&&"self"in n&&"location"in n)return!0}catch(n){}return!1}function w(n,t){for(var e=0;e<n.length;e++)try{if(n[e]===t)return e}catch(n){}return-1}var m=function(){function n(){if(this.name=void 0,this.weakmap=void 0,this.keys=void 0,this.values=void 0,this.name="__weakmap_"+(1e9*Math.random()>>>0)+"__",function(){if("undefined"==typeof WeakMap)return!1;if(void 0===Object.freeze)return!1;try{var n=new WeakMap,t={};return Object.freeze(t),n.set(t,"__testvalue__"),"__testvalue__"===n.get(t)}catch(n){return!1}}())try{this.weakmap=new WeakMap}catch(n){}this.keys=[],this.values=[]}var t=n.prototype;return t._cleanupClosedWindows=function(){for(var n=this.weakmap,t=this.keys,e=0;e<t.length;e++){var r=t[e];if(h(r)&&l(r)){if(n)try{n.delete(r)}catch(n){}t.splice(e,1),this.values.splice(e,1),e-=1}}},t.isSafeToReadWrite=function(n){return!h(n)},t.set=function(n,t){if(!n)throw new Error("WeakMap expected key");var e=this.weakmap;if(e)try{e.set(n,t)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var r=this.name,o=n[r];return void(o&&o[0]===n?o[1]=t:Object.defineProperty(n,r,{value:[n,t],writable:!0}))}catch(n){}this._cleanupClosedWindows();var i=this.keys,u=this.values,a=w(i,n);-1===a?(i.push(n),u.push(t)):u[a]=t},t.get=function(n){if(!n)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{if(t.has(n))return t.get(n)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var e=n[this.name];return e&&e[0]===n?e[1]:void 0}catch(n){}this._cleanupClosedWindows();var r=w(this.keys,n);if(-1!==r)return this.values[r]},t.delete=function(n){if(!n)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{t.delete(n)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var e=n[this.name];e&&e[0]===n&&(e[0]=e[1]=void 0)}catch(n){}this._cleanupClosedWindows();var r=this.keys,o=w(r,n);-1!==o&&(r.splice(o,1),this.values.splice(o,1))},t.has=function(n){if(!n)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{if(t.has(n))return!0}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var e=n[this.name];return!(!e||e[0]!==n)}catch(n){}return this._cleanupClosedWindows(),-1!==w(this.keys,n)},t.getOrSet=function(n,t){if(this.has(n))return this.get(n);var e=t();return this.set(n,e),e},n}()}])},,function(n,t,e){"undefined"!=typeof self&&self,n.exports=function(n){var t={};function e(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:r})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var o in n)e.d(r,o,function(t){return n[t]}.bind(null,o));return r},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return{}.hasOwnProperty.call(n,t)},e.p="",e(e.s=0)}([function(n,t,e){"use strict";function r(n){try{if(!n)return!1;if("undefined"!=typeof Promise&&n instanceof Promise)return!0;if("undefined"!=typeof window&&"function"==typeof window.Window&&n instanceof window.Window)return!1;if("undefined"!=typeof window&&"function"==typeof window.constructor&&n instanceof window.constructor)return!1;var t={}.toString;if(t){var e=t.call(n);if("[object Window]"===e||"[object global]"===e||"[object DOMWindow]"===e)return!1}if("function"==typeof n.then)return!0}catch(n){return!1}return!1}e.r(t),e.d(t,"ZalgoPromise",(function(){return d}));var o,i=[],u=[],a=0;function c(){if(!a&&o){var n=o;o=null,n.resolve()}}function s(){a+=1}function f(){a-=1,c()}var d=function(){function n(n){var t=this;if(this.resolved=void 0,this.rejected=void 0,this.errorHandled=void 0,this.value=void 0,this.error=void 0,this.handlers=void 0,this.dispatching=void 0,this.stack=void 0,this.resolved=!1,this.rejected=!1,this.errorHandled=!1,this.handlers=[],n){var e,r,o=!1,i=!1,u=!1;s();try{n((function(n){u?t.resolve(n):(o=!0,e=n)}),(function(n){u?t.reject(n):(i=!0,r=n)}))}catch(n){return f(),void this.reject(n)}f(),u=!0,o?this.resolve(e):i&&this.reject(r)}}var t=n.prototype;return t.resolve=function(n){if(this.resolved||this.rejected)return this;if(r(n))throw new Error("Can not resolve promise with another promise");return this.resolved=!0,this.value=n,this.dispatch(),this},t.reject=function(n){var t=this;if(this.resolved||this.rejected)return this;if(r(n))throw new Error("Can not reject promise with another promise");if(!n){var e=n&&"function"==typeof n.toString?n.toString():{}.toString.call(n);n=new Error("Expected reject to be called with Error, got "+e)}return this.rejected=!0,this.error=n,this.errorHandled||setTimeout((function(){t.errorHandled||function(n,t){if(-1===i.indexOf(n)){i.push(n),setTimeout((function(){throw n}),1);for(var e=0;e<u.length;e++)u[e](n,t)}}(n,t)}),1),this.dispatch(),this},t.asyncReject=function(n){return this.errorHandled=!0,this.reject(n),this},t.dispatch=function(){var t=this.resolved,e=this.rejected,o=this.handlers;if(!this.dispatching&&(t||e)){this.dispatching=!0,s();for(var i=function(n,t){return n.then((function(n){t.resolve(n)}),(function(n){t.reject(n)}))},u=0;u<o.length;u++){var a=o[u],c=a.onSuccess,d=a.onError,l=a.promise,h=void 0;if(t)try{h=c?c(this.value):this.value}catch(n){l.reject(n);continue}else if(e){if(!d){l.reject(this.error);continue}try{h=d(this.error)}catch(n){l.reject(n);continue}}if(h instanceof n&&(h.resolved||h.rejected)){var w=h;w.resolved?l.resolve(w.value):l.reject(w.error),w.errorHandled=!0}else r(h)?h instanceof n&&(h.resolved||h.rejected)?h.resolved?l.resolve(h.value):l.reject(h.error):i(h,l):l.resolve(h)}o.length=0,this.dispatching=!1,f()}},t.then=function(t,e){if(t&&"function"!=typeof t&&!t.call)throw new Error("Promise.then expected a function for success handler");if(e&&"function"!=typeof e&&!e.call)throw new Error("Promise.then expected a function for error handler");var r=new n;return this.handlers.push({promise:r,onSuccess:t,onError:e}),this.errorHandled=!0,this.dispatch(),r},t.catch=function(n){return this.then(void 0,n)},t.finally=function(t){if(t&&"function"!=typeof t&&!t.call)throw new Error("Promise.finally expected a function");return this.then((function(e){return n.try(t).then((function(){return e}))}),(function(e){return n.try(t).then((function(){throw e}))}))},t.timeout=function(n,t){var e=this;if(this.resolved||this.rejected)return this;var r=setTimeout((function(){e.resolved||e.rejected||e.reject(t||new Error("Promise timed out after "+n+"ms"))}),n);return this.then((function(n){return clearTimeout(r),n}))},t.toPromise=function(){if("undefined"==typeof Promise)throw new TypeError("Could not find Promise");return Promise.resolve(this)},t.lazy=function(){return this.errorHandled=!0,this},n.resolve=function(t){return t instanceof n?t:r(t)?new n((function(n,e){return t.then(n,e)})):(new n).resolve(t)},n.reject=function(t){return(new n).reject(t)},n.asyncReject=function(t){return(new n).asyncReject(t)},n.all=function(t){var e=new n,o=t.length,i=[].slice();if(!o)return e.resolve(i),e;for(var u=function(n,t,r){return t.then((function(t){i[n]=t,0==(o-=1)&&e.resolve(i)}),(function(n){r.reject(n)}))},a=0;a<t.length;a++){var c=t[a];if(c instanceof n){if(c.resolved){i[a]=c.value,o-=1;continue}}else if(!r(c)){i[a]=c,o-=1;continue}u(a,n.resolve(c),e)}return 0===o&&e.resolve(i),e},n.hash=function(t){var e={},o=[],i=function(n){if(t.hasOwnProperty(n)){var i=t[n];r(i)?o.push(i.then((function(t){e[n]=t}))):e[n]=i}};for(var u in t)i(u);return n.all(o).then((function(){return e}))},n.map=function(t,e){return n.all(t.map(e))},n.onPossiblyUnhandledException=function(n){return function(n){return u.push(n),{cancel:function(){u.splice(u.indexOf(n),1)}}}(n)},n.try=function(t,e,r){if(t&&"function"!=typeof t&&!t.call)throw new Error("Promise.try expected a function");var o;s();try{o=t.apply(e,r||[])}catch(t){return f(),n.reject(t)}return f(),n.resolve(o)},n.delay=function(t){return new n((function(n){setTimeout(n,t)}))},n.isPromise=function(t){return!!(t&&t instanceof n)||r(t)},n.flush=function(){return t=o=o||new n,c(),t;var t},n}()}])},function(n,t,e){"use strict";e.r(t),e.d(t,"Promise",(function(){return o.ZalgoPromise})),e.d(t,"TYPES",(function(){return Tn})),e.d(t,"ProxyWindow",(function(){return sn})),e.d(t,"setup",(function(){return An})),e.d(t,"destroy",(function(){return Mn})),e.d(t,"serializeMessage",(function(){return xn})),e.d(t,"deserializeMessage",(function(){return Sn})),e.d(t,"createProxyWindow",(function(){return Dn})),e.d(t,"toProxyWindow",(function(){return Cn})),e.d(t,"on",(function(){return Pn})),e.d(t,"once",(function(){return kn})),e.d(t,"send",(function(){return En})),e.d(t,"markWindowKnown",(function(){return U})),e.d(t,"cleanUpWindow",(function(){return In})),e.d(t,"bridge",(function(){}));var r=e(0),o=e(1),i="Call was rejected by callee.\r\n";function u(n){return void 0===n&&(n=window),n.location.protocol}function a(n){if(void 0===n&&(n=window),n.mockDomain){var t=n.mockDomain.split("//")[0];if(t)return t}return u(n)}function c(n){return void 0===n&&(n=window),"about:"===a(n)}function s(n){try{return!0}catch(n){}return!1}function f(n){void 0===n&&(n=window);var t=n.location;if(!t)throw new Error("Can not read window location");var e=u(n);if(!e)throw new Error("Can not read window protocol");if("file:"===e)return"file://";if("about:"===e){var r=function(n){if(void 0===n&&(n=window),n)try{if(n.parent&&n.parent!==n)return n.parent}catch(n){}}(n);return r&&s()?f(r):"about://"}var o=t.host;if(!o)throw new Error("Can not read window host");return e+"//"+o}function d(n){void 0===n&&(n=window);var t=f(n);return t&&n.mockDomain&&n.mockDomain.startsWith("mock:")?n.mockDomain:t}var l=[],h=[];function w(n,t){void 0===t&&(t=!0);try{if(n===window)return!1}catch(n){return!0}try{if(!n)return!0}catch(n){return!0}try{if(n.closed)return!0}catch(n){return!n||n.message!==i}if(t&&function(n){if(!function(n){try{if(n===window)return!0}catch(n){}try{var t=Object.getOwnPropertyDescriptor(n,"location");if(t&&!1===t.enumerable)return!1}catch(n){}try{if(c(n)&&s())return!0}catch(n){}try{if(function(n){return void 0===n&&(n=window),"mock:"===a(n)}(n)&&s())return!0}catch(n){}try{if(f(n)===f(window))return!0}catch(n){}return!1}(n))return!1;try{if(n===window)return!0;if(c(n)&&s())return!0;if(d(window)===d(n))return!0}catch(n){}return!1}(n))try{if(n.mockclosed)return!0}catch(n){}try{if(!n.parent||!n.top)return!0}catch(n){}var e=function(n,t){for(var e=0;e<n.length;e++)try{if(n[e]===t)return e}catch(n){}return-1}(l,n);if(-1!==e){var r=h[e];if(r&&function(n){if(!n.contentWindow)return!0;if(!n.parentNode)return!0;var t=n.ownerDocument;if(t&&t.documentElement&&!t.documentElement.contains(n)){for(var e=n;e.parentNode&&e.parentNode!==e;)e=e.parentNode;if(!e.host||!t.documentElement.contains(e.host))return!0}return!1}(r))return!0}return!1}function m(n){try{if(n===window)return!0}catch(n){if(n&&n.message===i)return!0}try{if("[object Window]"==={}.toString.call(n))return!0}catch(n){if(n&&n.message===i)return!0}try{if(window.Window&&n instanceof window.Window)return!0}catch(n){if(n&&n.message===i)return!0}try{if(n&&n.self===n)return!0}catch(n){if(n&&n.message===i)return!0}try{if(n&&n.parent===n)return!0}catch(n){if(n&&n.message===i)return!0}try{if(n&&n.top===n)return!0}catch(n){if(n&&n.message===i)return!0}try{if(n&&"__unlikely_value__"===n.__cross_domain_utils_window_check__)return!1}catch(n){return!0}try{if("postMessage"in n&&"self"in n&&"location"in n)return!0}catch(n){}return!1}function v(n,t){for(var e=0;e<n.length;e++)try{if(n[e]===t)return e}catch(n){}return-1}var p,y=function(){function n(){if(this.name=void 0,this.weakmap=void 0,this.keys=void 0,this.values=void 0,this.name="__weakmap_"+(1e9*Math.random()>>>0)+"__",function(){if("undefined"==typeof WeakMap)return!1;if(void 0===Object.freeze)return!1;try{var n=new WeakMap,t={};return Object.freeze(t),n.set(t,"__testvalue__"),"__testvalue__"===n.get(t)}catch(n){return!1}}())try{this.weakmap=new WeakMap}catch(n){}this.keys=[],this.values=[]}var t=n.prototype;return t._cleanupClosedWindows=function(){for(var n=this.weakmap,t=this.keys,e=0;e<t.length;e++){var r=t[e];if(m(r)&&w(r)){if(n)try{n.delete(r)}catch(n){}t.splice(e,1),this.values.splice(e,1),e-=1}}},t.isSafeToReadWrite=function(n){return!m(n)},t.set=function(n,t){if(!n)throw new Error("WeakMap expected key");var e=this.weakmap;if(e)try{e.set(n,t)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var r=this.name,o=n[r];return void(o&&o[0]===n?o[1]=t:Object.defineProperty(n,r,{value:[n,t],writable:!0}))}catch(n){}this._cleanupClosedWindows();var i=this.keys,u=this.values,a=v(i,n);-1===a?(i.push(n),u.push(t)):u[a]=t},t.get=function(n){if(!n)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{if(t.has(n))return t.get(n)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var e=n[this.name];return e&&e[0]===n?e[1]:void 0}catch(n){}this._cleanupClosedWindows();var r=v(this.keys,n);if(-1!==r)return this.values[r]},t.delete=function(n){if(!n)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{t.delete(n)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var e=n[this.name];e&&e[0]===n&&(e[0]=e[1]=void 0)}catch(n){}this._cleanupClosedWindows();var r=this.keys,o=v(r,n);-1!==o&&(r.splice(o,1),this.values.splice(o,1))},t.has=function(n){if(!n)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{if(t.has(n))return!0}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var e=n[this.name];return!(!e||e[0]!==n)}catch(n){}return this._cleanupClosedWindows(),-1!==v(this.keys,n)},t.getOrSet=function(n,t){if(this.has(n))return this.get(n);var e=t();return this.set(n,e),e},n}();function g(){return{}}function _(n){return n.name||n.__name__||n.displayName||"anonymous"}function b(n,t){try{delete n.name,n.name=t}catch(n){}return n.__name__=n.displayName=t,n}function W(){var n="0123456789abcdef";return"uid_"+"xxxxxxxxxx".replace(/./g,(function(){return n.charAt(Math.floor(Math.random()*n.length))}))+"_"+function(n){if("function"==typeof btoa)return btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,(function(n,t){return String.fromCharCode(parseInt(t,16))}))).replace(/[=]/g,"");if("undefined"!=typeof Buffer)return Buffer.from(n,"utf8").toString("base64").replace(/[=]/g,"");throw new Error("Can not find window.btoa or Buffer")}((new Date).toISOString().slice(11,19).replace("T",".")).replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}function O(n){try{return JSON.stringify([].slice.call(n),(function(n,t){return"function"==typeof t?"memoize["+function(n){if(p=p||new y,null==n||"object"!=typeof n&&"function"!=typeof n)throw new Error("Invalid object");var t=p.get(n);return t||(t=typeof n+":"+W(),p.set(n,t)),t}(t)+"]":function(n){var t=!1;try{(n instanceof window.Element||null!==n&&"object"==typeof n&&1===n.nodeType&&"object"==typeof n.style&&"object"==typeof n.ownerDocument)&&(t=!0)}catch(n){}return t}(t)?{}:t}))}catch(n){throw new Error("Arguments not serializable -- can not be used to memoize")}}var j=0,P=0;function k(n,t){void 0===t&&(t={});var e,r,o=t.thisNamespace,i=void 0!==o&&o,u=t.time,a=j;j+=1;var c=function(){for(var t=arguments.length,o=new Array(t),c=0;c<t;c++)o[c]=arguments[c];var s,f;a<P&&(e=null,r=null,a=j,j+=1),s=i?(r=r||new y).getOrSet(this,g):e=e||{};try{f=O(o)}catch(t){return n.apply(this,arguments)}var d=s[f];if(d&&u&&Date.now()-d.time<u&&(delete s[f],d=null),d)return d.value;var l=Date.now(),h=n.apply(this,arguments);return s[f]={time:l,value:h},h};return c.reset=function(){e=null,r=null},b(c,(t.name||_(n))+"::memoized")}function E(n){var t={};function e(){for(var e=arguments,r=this,i=arguments.length,u=new Array(i),a=0;a<i;a++)u[a]=arguments[a];var c=O(u);return t.hasOwnProperty(c)||(t[c]=o.ZalgoPromise.try((function(){return n.apply(r,e)})).finally((function(){delete t[c]}))),t[c]}return e.reset=function(){t={}},b(e,_(n)+"::promiseMemoized")}function x(){}function S(n,t){if(void 0===t&&(t=1),t>=3)return"stringifyError stack overflow";try{if(!n)return"<unknown error: "+{}.toString.call(n)+">";if("string"==typeof n)return n;if(n instanceof Error){var e=n&&n.stack,r=n&&n.message;if(e&&r)return e.includes(r)?e:r+"\n"+e;if(e)return e;if(r)return r}return n&&n.toString&&"function"==typeof n.toString?n.toString():{}.toString.call(n)}catch(n){return"Error while stringifying error: "+S(n,t+1)}}function D(n){return"string"==typeof n?n:n&&n.toString&&"function"==typeof n.toString?n.toString():{}.toString.call(n)}function C(n){return"[object RegExp]"==={}.toString.call(n)}function A(n,t,e){if(n.hasOwnProperty(t))return n[t];var r=e();return n[t]=r,r}k.clear=function(){P=j},k((function(n){if(Object.values)return Object.values(n);var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(n[e]);return t})),Error;var M=e(3);function T(n){void 0===n&&(n=window);var t="__post_robot_11_0_1__";return n!==window?n[t]:n[t]=n[t]||{}}var I=function(){return{}};function N(n,t){return void 0===n&&(n="store"),void 0===t&&(t=I),A(T(),n,(function(){var n=t();return{has:function(t){return n.hasOwnProperty(t)},get:function(t,e){return n.hasOwnProperty(t)?n[t]:e},set:function(t,e){return n[t]=e,e},del:function(t){delete n[t]},getOrSet:function(t,e){return A(n,t,e)},reset:function(){n=t()},keys:function(){return Object.keys(n)}}}))}var R=function(){};function z(){var n=T();return n.WINDOW_WILDCARD=n.WINDOW_WILDCARD||new R,n.WINDOW_WILDCARD}function F(n,t){return void 0===n&&(n="store"),void 0===t&&(t=I),N("windowStore").getOrSet(n,(function(){var e=new M.WeakMap,r=function(n){return e.getOrSet(n,t)};return{has:function(t){return r(t).hasOwnProperty(n)},get:function(t,e){var o=r(t);return o.hasOwnProperty(n)?o[n]:e},set:function(t,e){return r(t)[n]=e,e},del:function(t){delete r(t)[n]},getOrSet:function(t,e){return A(r(t),n,e)}}}))}function L(){return N("instance").getOrSet("instanceID",W)}function Z(n,t){var e=t.domain,r=F("helloPromises"),i=r.get(n);i&&i.resolve({domain:e});var u=o.ZalgoPromise.resolve({domain:e});return r.set(n,u),u}function B(n,t){return(0,t.send)(n,"postrobot_hello",{instanceID:L()},{domain:"*",timeout:-1}).then((function(t){var e=t.origin,r=t.data.instanceID;return Z(n,{domain:e}),{win:n,domain:e,instanceID:r}}))}function q(n,t){var e=t.send;return F("windowInstanceIDPromises").getOrSet(n,(function(){return B(n,{send:e}).then((function(n){return n.instanceID}))}))}function U(n){F("knownWindows").set(n,!0)}function H(){var n=document.body;if(!n)throw new Error("Body element not found");return n}function J(){return Boolean(document.body)&&"complete"===document.readyState}function K(){return Boolean(document.body)&&"interactive"===document.readyState}k((function(){return new o.ZalgoPromise((function(n){if(J()||K())n();else var t=setInterval((function(){(J()||K())&&(clearInterval(t),n())}),10)}))}));var Y,$="undefined"!=typeof document?document.currentScript:null,G=k((function(){if($)return $;if($=function(){try{var n=function(){try{throw new Error("_")}catch(n){return n.stack||""}}(),t=/.*at [^(]*\((.*):(.+):(.+)\)$/gi.exec(n),e=t&&t[1];if(!e)return;for(var r=0,o=[].slice.call(document.getElementsByTagName("script")).reverse();r<o.length;r++){var i=o[r];if(i.src&&i.src===e)return i}}catch(n){}}())return $;throw new Error("Can not determine current script")})),Q=W();function V(n){return"object"==typeof n&&null!==n&&"string"==typeof n.__type__}function X(n){return void 0===n?"undefined":null===n?"null":Array.isArray(n)?"array":"function"==typeof n?"function":"object"==typeof n?n instanceof Error?"error":"function"==typeof n.then?"promise":"[object RegExp]"==={}.toString.call(n)?"regex":"[object Date]"==={}.toString.call(n)?"date":"object":"string"==typeof n?"string":"number"==typeof n?"number":"boolean"==typeof n?"boolean":void 0}function nn(n,t){return{__type__:n,__val__:t}}k((function(){var n;try{n=G()}catch(n){return Q}var t=n.getAttribute("data-uid");if(t&&"string"==typeof t)return t;if((t=n.getAttribute("data-uid-auto"))&&"string"==typeof t)return t;if(n.src){var e=function(n){for(var t="",e=0;e<n.length;e++){var r=n[e].charCodeAt(0)*e;n[e+1]&&(r+=n[e+1].charCodeAt(0)*(e-1)),t+=String.fromCharCode(97+Math.abs(r)%26)}return t}(JSON.stringify({src:n.src,dataset:n.dataset}));t="uid_"+e.slice(e.length-30)}else t=W();return n.setAttribute("data-uid-auto",t),t}));var tn,en=((Y={}).function=function(){},Y.error=function(n){return nn("error",{message:n.message,stack:n.stack,code:n.code,data:n.data})},Y.promise=function(){},Y.regex=function(n){return nn("regex",n.source)},Y.date=function(n){return nn("date",n.toJSON())},Y.array=function(n){return n},Y.object=function(n){return n},Y.string=function(n){return n},Y.number=function(n){return n},Y.boolean=function(n){return n},Y.null=function(n){return n},Y[void 0]=function(n){return nn("undefined",n)},Y),rn={},on=((tn={}).function=function(){throw new Error("Function serialization is not implemented; nothing to deserialize")},tn.error=function(n){var t=n.stack,e=n.code,r=n.data,o=new Error(n.message);return o.code=e,r&&(o.data=r),o.stack=t+"\n\n"+o.stack,o},tn.promise=function(){throw new Error("Promise serialization is not implemented; nothing to deserialize")},tn.regex=function(n){return new RegExp(n)},tn.date=function(n){return new Date(n)},tn.array=function(n){return n},tn.object=function(n){return n},tn.string=function(n){return n},tn.number=function(n){return n},tn.boolean=function(n){return n},tn.null=function(n){return n},tn[void 0]=function(){},tn),un={};function an(){for(var n=N("idToProxyWindow"),t=0,e=n.keys();t<e.length;t++){var r=e[t];n.get(r).shouldClean()&&n.del(r)}}function cn(n,t){var e=t.send,i=t.id,u=void 0===i?W():i,a=n.then((function(n){if(Object(r.isSameDomain)(n))return Object(r.assertSameDomain)(n).name})),c=n.then((function(n){if(Object(r.isWindowClosed)(n))throw new Error("Window is closed, can not determine type");return Object(r.getOpener)(n)?r.WINDOW_TYPE.POPUP:r.WINDOW_TYPE.IFRAME}));a.catch(x),c.catch(x);var s=function(){return n.then((function(n){if(!Object(r.isWindowClosed)(n))return Object(r.isSameDomain)(n)?Object(r.assertSameDomain)(n).name:a}))};return{id:u,getType:function(){return c},getInstanceID:E((function(){return n.then((function(n){return q(n,{send:e})}))})),close:function(){return n.then(r.closeWindow)},getName:s,focus:function(){return n.then((function(n){n.focus()}))},isClosed:function(){return n.then((function(n){return Object(r.isWindowClosed)(n)}))},setLocation:function(t,e){return void 0===e&&(e={}),n.then((function(n){var o=window.location.protocol+"//"+window.location.host,i=e.method,u=void 0===i?"get":i,a=e.body;if(t.startsWith("/"))t=""+o+t;else if(!/^https?:\/\//.exec(t)&&!t.startsWith(o))throw new Error("Expected url to be http or https url, or absolute path, got "+JSON.stringify(t));if("post"===u)return s().then((function(n){if(!n)throw new Error("Can not post to window without target name");!function(n){var t=n.url,e=n.target,r=n.body,o=n.method,i=void 0===o?"post":o,u=document.createElement("form");if(u.setAttribute("target",e),u.setAttribute("method",i),u.setAttribute("action",t),u.style.display="none",r)for(var a=0,c=Object.keys(r);a<c.length;a++){var s,f=c[a],d=document.createElement("input");d.setAttribute("name",f),d.setAttribute("value",null==(s=r[f])?void 0:s.toString()),u.appendChild(d)}H().appendChild(u),u.submit(),H().removeChild(u)}({url:t,target:n,method:u,body:a})}));if("get"!==u)throw new Error("Unsupported method: "+u);if(Object(r.isSameDomain)(n))try{if(n.location&&"function"==typeof n.location.replace)return void n.location.replace(t)}catch(n){}n.location=t}))},setName:function(t){return n.then((function(n){var e=Object(r.isSameDomain)(n),i=Object(r.getFrameForWindow)(n);if(!e)throw new Error("Can not set name for cross-domain window: "+t);Object(r.assertSameDomain)(n).name=t,i&&i.setAttribute("name",t),a=o.ZalgoPromise.resolve(t)}))}}}new o.ZalgoPromise((function(n){if(window.document&&window.document.body)return n(window.document.body);var t=setInterval((function(){if(window.document&&window.document.body)return clearInterval(t),n(window.document.body)}),10)}));var sn=function(){function n(n){var t=n.send,e=n.win,r=n.serializedWindow;this.id=void 0,this.isProxyWindow=!0,this.serializedWindow=void 0,this.actualWindow=void 0,this.actualWindowPromise=void 0,this.send=void 0,this.name=void 0,this.actualWindowPromise=new o.ZalgoPromise,this.serializedWindow=r||cn(this.actualWindowPromise,{send:t}),N("idToProxyWindow").set(this.getID(),this),e&&this.setWindow(e,{send:t})}var t=n.prototype;return t.getID=function(){return this.serializedWindow.id},t.getType=function(){return this.serializedWindow.getType()},t.isPopup=function(){return this.getType().then((function(n){return n===r.WINDOW_TYPE.POPUP}))},t.setLocation=function(n,t){var e=this;return this.serializedWindow.setLocation(n,t).then((function(){return e}))},t.getName=function(){return this.serializedWindow.getName()},t.setName=function(n){var t=this;return this.serializedWindow.setName(n).then((function(){return t}))},t.close=function(){var n=this;return this.serializedWindow.close().then((function(){return n}))},t.focus=function(){var n=this,t=this.isPopup(),e=this.getName(),r=o.ZalgoPromise.hash({isPopup:t,name:e}).then((function(n){var t=n.name;n.isPopup&&t&&window.open("",t,"noopener")})),i=this.serializedWindow.focus();return o.ZalgoPromise.all([r,i]).then((function(){return n}))},t.isClosed=function(){return this.serializedWindow.isClosed()},t.getWindow=function(){return this.actualWindow},t.setWindow=function(n,t){var e=t.send;this.actualWindow=n,this.actualWindowPromise.resolve(this.actualWindow),this.serializedWindow=cn(this.actualWindowPromise,{send:e,id:this.getID()}),F("winToProxyWindow").set(n,this)},t.awaitWindow=function(){return this.actualWindowPromise},t.matchWindow=function(n,t){var e=this,r=t.send;return o.ZalgoPromise.try((function(){return e.actualWindow?n===e.actualWindow:o.ZalgoPromise.hash({proxyInstanceID:e.getInstanceID(),knownWindowInstanceID:q(n,{send:r})}).then((function(t){var o=t.proxyInstanceID===t.knownWindowInstanceID;return o&&e.setWindow(n,{send:r}),o}))}))},t.unwrap=function(){return this.actualWindow||this},t.getInstanceID=function(){return this.serializedWindow.getInstanceID()},t.shouldClean=function(){return Boolean(this.actualWindow&&Object(r.isWindowClosed)(this.actualWindow))},t.serialize=function(){return this.serializedWindow},n.unwrap=function(t){return n.isProxyWindow(t)?t.unwrap():t},n.serialize=function(t,e){var r=e.send;return an(),n.toProxyWindow(t,{send:r}).serialize()},n.deserialize=function(t,e){var r=e.send;return an(),N("idToProxyWindow").get(t.id)||new n({serializedWindow:t,send:r})},n.isProxyWindow=function(n){return Boolean(n&&!Object(r.isWindow)(n)&&n.isProxyWindow)},n.toProxyWindow=function(t,e){var r=e.send;if(an(),n.isProxyWindow(t))return t;var o=t;return F("winToProxyWindow").get(o)||new n({win:o,send:r})},n}();function fn(n,t,e,r,o){var i=F("methodStore"),u=N("proxyWindowMethods");sn.isProxyWindow(r)?u.set(n,{val:t,name:e,domain:o,source:r}):(u.del(n),i.getOrSet(r,(function(){return{}}))[n]={domain:o,name:e,val:t,source:r})}function dn(n,t){var e=F("methodStore"),r=N("proxyWindowMethods");return e.getOrSet(n,(function(){return{}}))[t]||r.get(t)}function ln(n,t,e,i,u){var a,c,s;c=(a={on:u.on,send:u.send}).on,s=a.send,N("builtinListeners").getOrSet("functionCalls",(function(){return c("postrobot_method",{domain:"*"},(function(n){var t=n.source,e=n.origin,i=n.data,u=i.id,a=i.name,c=dn(t,u);if(!c)throw new Error("Could not find method '"+a+"' with id: "+i.id+" in "+Object(r.getDomain)(window));var f=c.source,d=c.domain,l=c.val;return o.ZalgoPromise.try((function(){if(!Object(r.matchDomain)(d,e))throw new Error("Method '"+i.name+"' domain "+JSON.stringify(C(c.domain)?c.domain.source:c.domain)+" does not match origin "+e+" in "+Object(r.getDomain)(window));if(sn.isProxyWindow(f))return f.matchWindow(t,{send:s}).then((function(n){if(!n)throw new Error("Method call '"+i.name+"' failed - proxy window does not match source in "+Object(r.getDomain)(window))}))})).then((function(){return l.apply({source:t,origin:e},i.args)}),(function(n){return o.ZalgoPromise.try((function(){if(l.onError)return l.onError(n)})).then((function(){var t,e;throw n.stack&&(n.stack="Remote call to "+a+"("+(void 0===(t=i.args)&&(t=[]),(e=t,[].slice.call(e)).map((function(n){return"string"==typeof n?"'"+n+"'":void 0===n?"undefined":null===n?"null":"boolean"==typeof n?n.toString():Array.isArray(n)?"[ ... ]":"object"==typeof n?"{ ... }":"function"==typeof n?"() => { ... }":"<"+typeof n+">"})).join(", ")+") failed\n\n")+n.stack),n}))})).then((function(n){return{result:n,id:u,name:a}}))}))}));var f=e.__id__||W();n=sn.unwrap(n);var d=e.__name__||e.name||i;return"string"==typeof d&&"function"==typeof d.indexOf&&d.startsWith("anonymous::")&&(d=d.replace("anonymous::",i+"::")),sn.isProxyWindow(n)?(fn(f,e,d,n,t),n.awaitWindow().then((function(n){fn(f,e,d,n,t)}))):fn(f,e,d,n,t),nn("cross_domain_function",{id:f,name:d})}function hn(n,t,e,o){var i,u=o.on,a=o.send;return function(n,t){void 0===t&&(t=rn);var e=JSON.stringify(n,(function(n){var e,r=this[n];if(V(this))return r;var o=X(r);if(!o)return r;var i=null!=(e=t[o])?e:en[o];return i?i(r,n):r}));return void 0===e?"undefined":e}(e,((i={}).promise=function(e,r){return function(n,t,e,r,o){return nn("cross_domain_zalgo_promise",{then:ln(n,t,(function(n,t){return e.then(n,t)}),r,{on:o.on,send:o.send})})}(n,t,e,r,{on:u,send:a})},i.function=function(e,r){return ln(n,t,e,r,{on:u,send:a})},i.object=function(n){return Object(r.isWindow)(n)||sn.isProxyWindow(n)?nn("cross_domain_window",sn.serialize(n,{send:a})):n},i))}function wn(n,t,e,i){var u,a=i.send;return function(n,t){if(void 0===t&&(t=un),"undefined"!==n)return JSON.parse(n,(function(n,e){var r,o,i;if(V(this))return e;if(V(e)?(o=e.__type__,i=e.__val__):(o=X(e),i=e),!o)return i;var u=null!=(r=t[o])?r:on[o];return u?u(i,n):i}))}(e,((u={}).cross_domain_zalgo_promise=function(n){return function(n,t,e){return new o.ZalgoPromise(e.then)}(0,0,n)},u.cross_domain_function=function(e){return function(n,t,e,o){var i=e.id,u=e.name,a=o.send,c=function(e){function o(){var c=arguments;return sn.toProxyWindow(n,{send:a}).awaitWindow().then((function(n){var s=dn(n,i);if(s&&s.val!==o)return s.val.apply({source:window,origin:Object(r.getDomain)()},c);var f=[].slice.call(c);return e.fireAndForget?a(n,"postrobot_method",{id:i,name:u,args:f},{domain:t,fireAndForget:!0}):a(n,"postrobot_method",{id:i,name:u,args:f},{domain:t,fireAndForget:!1}).then((function(n){return n.data.result}))})).catch((function(n){throw n}))}return void 0===e&&(e={}),o.__name__=u,o.__origin__=t,o.__source__=n,o.__id__=i,o.origin=t,o},s=c();return s.fireAndForget=c({fireAndForget:!0}),s}(n,t,e,{send:a})},u.cross_domain_window=function(n){return sn.deserialize(n,{send:a})},u))}var mn={};function vn(n,t,e,i){var u=i.on,a=i.send;return o.ZalgoPromise.try((function(){var i=F().getOrSet(n,(function(){return{}}));return i.buffer=i.buffer||[],i.buffer.push(e),i.flush=i.flush||o.ZalgoPromise.flush().then((function(){if(Object(r.isWindowClosed)(n))throw new Error("Window is closed");var e,o=hn(n,t,((e={}).__post_robot_11_0_1__=i.buffer||[],e),{on:u,send:a});delete i.buffer;for(var c=Object.keys(mn),s=[],f=0;f<c.length;f++){var d=c[f];try{mn[d](n,o,t)}catch(n){s.push(n)}}if(s.length===c.length)throw new Error("All post-robot messaging strategies failed:\n\n"+s.map((function(n,t){return t+". "+S(n)})).join("\n\n"))})),i.flush.then((function(){delete i.flush}))})).then(x)}function pn(n){return N("responseListeners").get(n)}function yn(n){N("responseListeners").del(n)}function gn(n){return N("erroredResponseListeners").has(n)}function _n(n){var t=n.name,e=n.win,o=n.domain,i=F("requestListeners");if("*"===e&&(e=null),"*"===o&&(o=null),!t)throw new Error("Name required to get request listener");for(var u=0,a=[e,z()];u<a.length;u++){var c=a[u];if(c){var s=i.get(c);if(s){var f=s[t];if(f){if(o&&"string"==typeof o){if(f[o])return f[o];if(f.__domain_regex__)for(var d=0,l=f.__domain_regex__;d<l.length;d++){var h=l[d],w=h.regex,m=h.listener;if(Object(r.matchDomain)(w,o))return m}}if(f["*"])return f["*"]}}}}}function bn(n,t,e,i){var u=i.on,a=i.send,c=_n({name:e.name,win:n,domain:t}),s="postrobot_method"===e.name&&e.data&&"string"==typeof e.data.name?e.data.name+"()":e.name;function f(i,c,f){return o.ZalgoPromise.flush().then((function(){if(!e.fireAndForget&&!Object(r.isWindowClosed)(n))try{return vn(n,t,{id:W(),origin:Object(r.getDomain)(window),type:"postrobot_message_response",hash:e.hash,name:e.name,ack:i,data:c,error:f},{on:u,send:a})}catch(n){throw new Error("Send response message failed for "+s+" in "+Object(r.getDomain)()+"\n\n"+S(n))}}))}return o.ZalgoPromise.all([o.ZalgoPromise.flush().then((function(){if(!e.fireAndForget&&!Object(r.isWindowClosed)(n))try{return vn(n,t,{id:W(),origin:Object(r.getDomain)(window),type:"postrobot_message_ack",hash:e.hash,name:e.name},{on:u,send:a})}catch(n){throw new Error("Send ack message failed for "+s+" in "+Object(r.getDomain)()+"\n\n"+S(n))}})),o.ZalgoPromise.try((function(){if(!c)throw new Error("No handler found for post message: "+e.name+" from "+t+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);return c.handler({source:n,origin:t,data:e.data})})).then((function(n){return f("success",n)}),(function(n){return f("error",null,n)}))]).then(x).catch((function(n){if(!c||!c.handleError)throw n;c.handleError(n)}))}function Wn(n,t,e){if(!gn(e.hash)){var o=pn(e.hash);if(!o)throw new Error("No handler found for post message ack for message: "+e.name+" from "+t+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);try{if(!Object(r.matchDomain)(o.domain,t))throw new Error("Ack origin "+t+" does not match domain "+o.domain.toString());if(n!==o.win)throw new Error("Ack source does not match registered window")}catch(n){o.promise.reject(n)}o.ack=!0}}function On(n,t,e){if(!gn(e.hash)){var o=pn(e.hash);if(!o)throw new Error("No handler found for post message response for message: "+e.name+" from "+t+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!Object(r.matchDomain)(o.domain,t))throw new Error("Response origin "+t+" does not match domain "+Object(r.stringifyDomainPattern)(o.domain));if(n!==o.win)throw new Error("Response source does not match registered window");yn(e.hash),"error"===e.ack?o.promise.reject(e.error):"success"===e.ack&&o.promise.resolve({source:n,origin:t,data:e.data})}}function jn(n,t){var e=t.on,o=t.send,i=N("receivedMessages");try{if(!window||window.closed||!n.source)return}catch(n){return}var u=n.source,a=n.origin,c=function(n,t,e,r){var o,i=r.on,u=r.send;try{o=wn(t,e,n,{on:i,send:u})}catch(n){return}if(o&&"object"==typeof o&&null!==o){var a=o.__post_robot_11_0_1__;if(Array.isArray(a))return a}}(n.data,u,a,{on:e,send:o});if(c){U(u);for(var s=0;s<c.length;s++){var f=c[s];if(i.has(f.id))return;if(i.set(f.id,!0),Object(r.isWindowClosed)(u)&&!f.fireAndForget)return;f.origin.startsWith(r.PROTOCOL.FILE)&&(a=r.PROTOCOL.FILE+"//");try{"postrobot_message_request"===f.type?bn(u,a,f,{on:e,send:o}):"postrobot_message_response"===f.type?On(u,a,f):"postrobot_message_ack"===f.type&&Wn(u,a,f)}catch(n){setTimeout((function(){throw n}),0)}}}}function Pn(n,t,e){if(!n)throw new Error("Expected name");if("function"==typeof(t=t||{})&&(e=t,t={}),!e)throw new Error("Expected handler");var r=function n(t,e){var r=t.name,o=t.win,i=t.domain,u=F("requestListeners");if(!r||"string"!=typeof r)throw new Error("Name required to add request listener");if(o&&"*"!==o&&sn.isProxyWindow(o)){var a=o.awaitWindow().then((function(t){return n({name:r,win:t,domain:i},e)}));return{cancel:function(){a.then((function(n){return n.cancel()}),x)}}}var c=o;if(Array.isArray(c)){for(var s=[],f=0,d=c;f<d.length;f++)s.push(n({name:r,domain:i,win:d[f]},e));return{cancel:function(){for(var n=0;n<s.length;n++)s[n].cancel()}}}if(Array.isArray(i)){for(var l=[],h=0,w=i;h<w.length;h++)l.push(n({name:r,win:c,domain:w[h]},e));return{cancel:function(){for(var n=0;n<l.length;n++)l[n].cancel()}}}var m=_n({name:r,win:c,domain:i});c&&"*"!==c||(c=z());var v=(i=i||"*").toString();if(m)throw c&&i?new Error("Request listener already exists for "+r+" on domain "+i.toString()+" for "+(c===z()?"wildcard":"specified")+" window"):c?new Error("Request listener already exists for "+r+" for "+(c===z()?"wildcard":"specified")+" window"):i?new Error("Request listener already exists for "+r+" on domain "+i.toString()):new Error("Request listener already exists for "+r);var p,y,g=u.getOrSet(c,(function(){return{}})),_=A(g,r,(function(){return{}}));return C(i)?(p=A(_,"__domain_regex__",(function(){return[]}))).push(y={regex:i,listener:e}):_[v]=e,{cancel:function(){delete _[v],y&&(p.splice(p.indexOf(y,1)),p.length||delete _.__domain_regex__),Object.keys(_).length||delete g[r],c&&!Object.keys(g).length&&u.del(c)}}}({name:n,win:t.window,domain:t.domain||"*"},{handler:e||t.handler,handleError:t.errorHandler||function(n){throw n}});return{cancel:function(){r.cancel()}}}function kn(n,t,e){"function"==typeof(t=t||{})&&(e=t,t={});var r,i=new o.ZalgoPromise;return t.errorHandler=function(n){r.cancel(),i.reject(n)},r=Pn(n,t,(function(n){if(r.cancel(),i.resolve(n),e)return e(n)})),i.cancel=r.cancel,i}mn.postrobot_post_message=function(n,t,e){e.startsWith(r.PROTOCOL.FILE)&&(e="*"),n.postMessage(t,e)};var En=function n(t,e,i,u){var a=(u=u||{}).domain||"*",c=u.timeout||-1,s=u.timeout||5e3,f=u.fireAndForget||!1;return sn.toProxyWindow(t,{send:n}).awaitWindow().then((function(t){return o.ZalgoPromise.try((function(){if(function(n,t,e){if(!n)throw new Error("Expected name");if(e&&"string"!=typeof e&&!Array.isArray(e)&&!C(e))throw new TypeError("Can not send "+n+". Expected domain "+JSON.stringify(e)+" to be a string, array, or regex");if(Object(r.isWindowClosed)(t))throw new Error("Can not send "+n+". Target window is closed")}(e,t,a),Object(r.isAncestor)(window,t))return function(n,t,e){void 0===t&&(t=5e3),void 0===e&&(e="Window");var r=function(n){return F("helloPromises").getOrSet(n,(function(){return new o.ZalgoPromise}))}(n);return-1!==t&&(r=r.timeout(t,new Error(e+" did not load after "+t+"ms"))),r}(t,s)})).then((function(e){return function(n,t,e,i){var u=i.send;return o.ZalgoPromise.try((function(){return"string"==typeof t?t:o.ZalgoPromise.try((function(){return e||B(n,{send:u}).then((function(n){return n.domain}))})).then((function(n){if(!Object(r.matchDomain)(t,t))throw new Error("Domain "+D(t)+" does not match "+D(t));return n}))}))}(t,a,(void 0===e?{}:e).domain,{send:n})})).then((function(u){var a,s,d=u,l="postrobot_method"===e&&i&&"string"==typeof i.name?i.name+"()":e,h=new o.ZalgoPromise,w=e+"_"+W();if(!f){var m={name:e,win:t,domain:d,promise:h};!function(n,t){N("responseListeners").set(n,t)}(w,m);var v=F("requestPromises").getOrSet(t,(function(){return[]}));v.push(h),h.catch((function(){!function(n){N("erroredResponseListeners").set(n,!0)}(w),yn(w)}));var p=function(n){return F("knownWindows").get(n,!1)}(t)?1e4:2e3,y=c,g=p,_=y,b=(a=function(){return Object(r.isWindowClosed)(t)?h.reject(new Error("Window closed for "+e+" before "+(m.ack?"response":"ack"))):m.cancelled?h.reject(new Error("Response listener was cancelled for "+e)):(g=Math.max(g-500,0),-1!==_&&(_=Math.max(_-500,0)),m.ack||0!==g?0===_?h.reject(new Error("No response for postMessage "+l+" in "+Object(r.getDomain)()+" in "+y+"ms")):void 0:h.reject(new Error("No ack for postMessage "+l+" in "+Object(r.getDomain)()+" in "+p+"ms")))},500,function n(){s=setTimeout((function(){a(),n()}),500)}(),{cancel:function(){clearTimeout(s)}});h.finally((function(){b.cancel(),v.splice(v.indexOf(h,1))})).catch(x)}return vn(t,d,{id:W(),origin:Object(r.getDomain)(window),type:"postrobot_message_request",hash:w,name:e,data:i,fireAndForget:f},{on:Pn,send:n}).then((function(){return f?h.resolve():h}),(function(n){throw new Error("Send request message failed for "+l+" in "+Object(r.getDomain)()+"\n\n"+S(n))}))}))}))};function xn(n,t,e){return hn(n,t,e,{on:Pn,send:En})}function Sn(n,t,e){return wn(n,t,e,{on:Pn,send:En})}function Dn(n){return new sn({send:En,win:n})}function Cn(n){return sn.toProxyWindow(n,{send:En})}function An(){var n,t,e,i;T().initialized||(T().initialized=!0,t=(n={on:Pn,send:En}).on,e=n.send,(i=T()).receiveMessage=i.receiveMessage||function(n){jn(n,{on:t,send:e})},function(n){var t=n.on,e=n.send;N().getOrSet("postMessageListener",(function(){return(n=window).addEventListener("message",i=function(n){!function(n,t){var e=t.on,i=t.send;o.ZalgoPromise.try((function(){var t=n.source||n.sourceElement,o=n.origin||n.originalEvent&&n.originalEvent.origin,u=n.data;if("null"===o&&(o=r.PROTOCOL.FILE+"//"),t){if(!o)throw new Error("Post message did not have origin domain");jn({source:t,origin:o,data:u},{on:e,send:i})}}))}(n,{on:t,send:e})}),{cancel:function(){n.removeEventListener("message",i)}};var n,i}))}({on:Pn,send:En}),function(n){var t=n.on,e=n.send;N("builtinListeners").getOrSet("helloListener",(function(){var n=t("postrobot_hello",{domain:"*"},(function(n){return Z(n.source,{domain:n.origin}),{instanceID:L()}})),o=Object(r.getAncestor)();return o&&B(o,{send:e}).catch((function(n){})),n}))}({on:Pn,send:En}))}function Mn(){var n;!function(){for(var n=N("responseListeners"),t=0,e=n.keys();t<e.length;t++){var r=e[t],o=n.get(r);o&&(o.cancelled=!0),n.del(r)}}(),(n=N().get("postMessageListener"))&&n.cancel(),delete window.__post_robot_11_0_1__}var Tn=!0;function In(n){for(var t=0,e=F("requestPromises").get(n,[]);t<e.length;t++)e[t].reject(new Error("Window "+(Object(r.isWindowClosed)(n)?"closed":"cleaned up")+" before response")).catch(x)}An()}])}));
//# sourceMappingURL=post-robot.min.js.map